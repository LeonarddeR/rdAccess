# Доступность Удалённого Рабочего Стола #

* Авторы: [Leonard de Ruijter][1]
* Загрузить [последнюю стабильную версию][2]
* Совместимость с NVDA: 2024.1 и выше

Дополнение RDAccess (Remote Desktop Accessibility, Доступность удаленного
рабочего стола) добавляет поддержку доступа к сеансам удалённого рабочего
стола в NVDA с помощью Удалённого Рабочего Стола Microsoft, Citrix или
VMware Horizon.  При установке в NVDA как на клиенте, так и на сервере, речь
и брайль, сгенерированные на сервере, будут воспроизводиться на клиентском
компьютере.  Это позволяет пользователю управлять удаленной системой так же
эффективно, как и локальной системой.

## Возможности

* Поддержка Microsoft Remote Desktop(включая Azure Virtual Desktop и
  Microsoft Cloud PC), Citrix и VMware Horizon
* Вывод речи и брайля
* Автоматическое распознавание удалённого Брайля с помощью функции
  автоматического распознавания брайлевского дисплея NVDA
* Автоматическое распознавание удалённой речи с помощью специального
  процесса обнаружения, который можно отключить в диалоге настроек NVDA
* Поддержка переносных копий NVDA, запущенных на сервере (для Citrix
  требуется дополнительная настройка)
* Полная поддержка переносных копий NVDA, запущенных на клиенте (для
  установки дополнения не требуются дополнительные административные
  привилегии)
* Несколько активных клиентских сеансов одновременно
* Удалённый рабочий стол доступен мгновенно после запуска NVDA
* Возможность управлять определёнными настройками синтезатора и брайлевского
  дисплея, не выходя из удалённого сеанса
* Возможность использования речи и брайля в пользовательском сеансе при
  доступе к защищённым рабочим столам

## Журнал изменений

### Версия 1.5

* Добавлена возможность создать диагностический отчёт отладки с помощью
  кнопки на панели настроек RDAccess
  [#23](https://github.com/leonardder/rdAccess/pull/23).
* Поддержка многострочных брайлевских дисплеев в NVDA 2025.1 и новее
  [#19](https://github.com/leonardder/rdAccess/pull/13).
* Минимальная совместимая версия NVDA теперь 2024,1. Удалена поддержка более
  ранних версий.
* Добавлены уведомления о подключении клиента
  [#25](https://github.com/leonardder/rdAccess/pull/25).
* Обновлена зависимость RdPipe.
* Обновлены переводы.

### Версия 1.4

* Новый стабильный выпуск.

### Версия 1.3

* Исправлены повреждённые жесты брайлевского дисплея.

### Версия 1.2

* Используется [ruff](https://github.com/astral-sh/ruff) в качестве
  форматера и
  линтера. [#13](https://github.com/leonardder/rdAccess/pull/13).
* Исправлена ​​проблема, в которой NVDA на клиенте генерирует ошибку при
  приостановке речи на сервере.
* Исправлена поддержка для
  `winAPI.secureDesktop.post_secureDesktopStateChange`.
* Улучшена инициализация драйвера на сервере.

### Версия 1.1

* Добавлена ​​поддержка для регистрации устройства в стиле NVDA 2023.3 для
  автоматического обнаружения брайлевских
  дисплеев. [#11](https://github.com/leonardder/rdAccess/pull/11).
* Добавлена поддержка NVDA 2024.1 Alpha точка расширения
  `winAPI.secureDesktop.post_secureDesktopStateChange`.
  [#12](https://github.com/leonardder/rdAccess/pull/12).

### Версия 1.0

Первоначальный стабильный выпуск.

## Приступая к работе

1. Установите RDAccess как в клиентской, так и в серверной копии NVDA.
1. Удалённая система должна автоматически начать говорить, используя
   локальный синтезатор речи. Если нет, то в экземпляре NVDA на сервере
   выберите удалённый синтезатор речи в диалоге выбора синтезатора NVDA.
1. Чтобы использовать брайль, включите автоматическое определение
   брайлевского дисплея в диалоге выбора брайлевского дисплея.

## Конфигурация

После установки дополнение RDAccess можно настроить с помощью диалога настроек NVDA, доступ к которому можно получить из меню NVDA, выбрав "Параметры" > "Настройки..."
После этого выберите категорию "Доступность удалённого рабочего стола".

Этот диалог содержит следующие настройки:

### Включить доступ к удалённому рабочему столу для

Этот список флажков определяет режим работы дополнения. Вы можете выбирать
между:

* Входящие подключения (сервер удалённого рабочего стола): Выберите этот
  параметр, если текущий экземпляр NVDA запущен на сервере удалённого
  рабочего стола.
* Исходящие подключения (клиент удалённого рабочего стола): Выберите этот
  параметр, если текущий экземпляр NVDA запущен на клиенте удалённого
  рабочего стола, который подключается к одному или нескольким серверам.
* Пропуск на безопасный рабочий стол: выберите этот параметр, если вы хотите
  использовать Брайль и речь из пользовательского экземпляра NVDA при
  доступе к безопасному рабочему столу. Обратите внимание, что для того,
  чтобы это сработало, вам необходимо сделать дополнение RDAccess доступным
  в копии NVDA на защищённом рабочем столе. Для этого выберите "Использовать
  последнюю сохранённую конфигурацию на экране входа в систему и на других
  защищённых экранах (требуются права администратора)" в общих настройках
  NVDA.

Для обеспечения бесперебойной работы с дополнением все опции включены по
умолчанию. Однако рекомендуется отключать серверный или клиентский режим в
зависимости от обстоятельств.

### Автоматически восстанавливать удалённую речь после сбоя соединения

Эта опция доступна только в режиме сервера. Это гарантирует, что соединение
будет автоматически восстановлено при включении удалённого синтезатора речи
и потере соединения, подобно автоматическому определению брайлевского
дисплея.

Эта опция включена по умолчанию. Настоятельно рекомендуется оставить эту
опцию включённой, если на сервере удалённого рабочего стола нет аудиовыхода.

### Разрешить удалённой системе управлять настройками драйвера

Если эта опция включена, она позволяет управлять настройками драйвера
(например, голосом и высотой тона синтезатора) из удалённой
системы. Изменения, внесённые в удалённую систему, будут автоматически
отражены на локальном компьютере.

### Сохранять постоянную поддержку клиента при выходе из NVDA

Этот параметр клиента доступен только в установленных копиях NVDA, Если он
включён, это гарантирует, что клиентская часть NVDA будет загружена в клиент
удалённого рабочего стола, даже если NVDA не запущена.

Чтобы использовать клиентскую часть RDAccess, необходимо внести несколько
изменений в реестр Windows.  Дополнение гарантирует, что эти изменения будут
внесены в профиль текущего пользователя.  Для этих изменений не требуются
права администратора.  Таким образом, NVDA может автоматически применять
необходимые изменения при загрузке и отменять их при выходе из NVDA.  Это
гарантирует полную совместимость дополнения с переносными версиями NVDA.

Эта опция отключена по умолчанию. Однако, если вы запускаете установленную
копию и являетесь единственным пользователем системы, рекомендуется включить
эту опцию для плавной работы при подключении к удаленной системе после
запуска NVDA.

### Включить поддержку удалённого рабочего стола Microsoft

Этот параметр включен по умолчанию и гарантирует, что клиентская часть
RDAccess будет загружена в клиент удалённого рабочего стола Microsoft
(mstsc) при запуске NVDA.  Если постоянная поддержка клиентов не включена с
помощью предыдущей опции, эти изменения будут автоматически отменены при
выходе из NVDA.

### Включить поддержку Citrix Workspace

Эта опция включена по умолчанию и гарантирует, что клиентская часть RDAccess
будет загружена в приложение Citrix Workspace при запуске NVDA.  Если не
включена постоянная поддержка клиентов путём включения предыдущей опции, эти
изменения будут автоматически отменены при выходе из NVDA.

Эта опция доступна только в следующих случаях:

* Установлен Citrix Workspace. Обратите внимание, что версия приложения из
  магазина Windows Store не поддерживается из-за ограничений в самом
  приложении.
* Можно зарегистрировать RDAccess в контексте текущего пользователя. После
  установки приложения вам необходимо один раз запустить удалённый сеанс,
  чтобы это стало возможным.

### Уведомлять об изменениях подключения с помощью

Этот комбинированный список позволяет вам управлять уведомлениями,
получаемыми, когда удалённая система открывает или закрывает соединения
удалённой речи или брайля.  Вы можете выбрать между:

* Отключены (без уведомлений)
* Сообщения (например, "Удаленный Брайль подключен")
* Звуки (NVDA 2025.1+)
* Сообщения и звуки

Обратите внимание, что звуки недоступны в версиях NVDA старше 2025.1. В
старых версиях будут использоваться сигналы.

### Открыть диагностический отчёт

Эта кнопка открывает просмотровое сообщение с выводом JSON, содержащее
некоторую диагностику, которая может помочь в отладке.  При [подаче проблемы
в GitHub][4], вас могут попросить предоставить этот отчет.

## Конкретные инструкции Citrix

При использовании RDAccess в приложении Citrix Workspace необходимо обратить
внимание на несколько важных моментов:

### Требования на стороне клиента

1. Версия приложения из магазина Windows Store *не* поддерживается.
1. После установки Citrix Workspace вам необходимо один раз запустить
   удалённый сеанс, чтобы разрешить регистрацию RDAccess. Причина этого
   заключается в том, что приложение копирует конфигурацию системы в
   конфигурацию пользователя при первом запуске сеанса. После этого RDAccess
   может самостоятельно зарегистрироваться в текущем пользовательском
   контексте.

### Требования к серверной части

В Citrix Virtual Apps и Desktops 2109 Citrix включила так называемый список
разрешенных виртуальных каналов. Это означает, что сторонние виртуальные
каналы, включая канал, необходимый для RDAccess, по умолчанию запрещены. Для
получения дополнительной информации [смотрите эту запись в блоге
Citrix](https://www.citrix.com/blogs/2021/10/14/virtual-channel-allow-list-now-enabled-by-default/).

Явное разрешение канала RdPipe, требуемого RDAccess, еще не
протестировано. На данный момент, вероятно, лучше всего полностью отключить
список разрешений. Если ваш системный администратор недоволен этим, не
стесняйтесь [написать об этом в соответствующем выпуске][3].

## Проблемы и вклад в их решение

Если вы хотите сообщить о проблеме или внести свой вклад, загляните на
[страницу проблем на Github][4].

## Внешние компоненты

Это дополнение основано на [RD Pipe][5], библиотеке, написанной на Rust и
поддерживающей клиентскую поддержку удаленных рабочих столов.  RD Pipe
распространяется как часть этого дополнения в соответствии с условиями
[версии 3 GNU Affero General Public License][5], опубликованными Фондом
свободного программного обеспечения (Free Software Foundation).

[[!tag stable dev beta]]

[1]: https://github.com/leonardder/

[2]: https://www.nvaccess.org/addonStore/legacy?file=rdAccess

[3]: https://github.com/leonardder/rdAccess/issues/1

[4]: https://github.com/leonardder/rdAccess/issues

[5]: https://github.com/leonardder/rd_pipe-rs

[6]: https://github.com/leonardder/rd_pipe-rs/blob/master/LICENSE
